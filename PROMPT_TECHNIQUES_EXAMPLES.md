# 提示工程技术详解与示例

## 基础提示技术

### 1. 零样本提示（Zero-shot Prompting）

#### 基础示例
```
提示：将以下句子分类为积极、消极或中性情感。

句子："这部电影超出了我的预期。"
```

#### 进阶示例
```
提示：作为数据分析师，评估以下业务指标的健康状况：
- 月活跃用户：150万（上月：120万）
- 用户留存率：45%（上月：42%）
- 平均使用时长：35分钟（上月：38分钟）

请提供整体评估和改进建议。
```

### 2. 单样本提示（One-shot Prompting）

#### 示例
```
提示：按照下面的格式提取信息。

示例：
输入："张三，28岁，软件工程师，在北京工作5年。"
输出：
{
  "姓名": "张三",
  "年龄": 28,
  "职业": "软件工程师",
  "工作地点": "北京",
  "工作年限": 5
}

现在提取：
输入："李四，35岁，产品经理，在上海工作8年。"
```

### 3. 少样本提示（Few-shot Prompting）

#### 文本分类示例
```
将客户反馈分类为：产品问题、服务问题、价格问题、其他

反馈："产品质量不错，但是价格有点贵。" → 价格问题
反馈："客服态度很差，等了很久才回复。" → 服务问题
反馈："收到的商品有破损，包装也不好。" → 产品问题

反馈："能否增加更多支付方式？" → 
```

#### 代码生成示例
```python
# 将自然语言转换为SQL查询

输入："获取所有年龄大于30的用户"
输出：SELECT * FROM users WHERE age > 30;

输入："计算每个部门的平均工资"
输出：SELECT department, AVG(salary) FROM employees GROUP BY department;

输入："找出订单金额前10的客户"
输出：
```

### 4. 思维链提示（Chain-of-Thought）

#### 数学推理示例
```
问题：一个水池有两个水管。A管单独注满需要3小时，B管单独注满需要4小时。如果两管同时开启，需要多长时间注满水池？

让我们逐步分析：
1. A管每小时注入水池的1/3
2. B管每小时注入水池的1/4
3. 两管同时工作，每小时注入：1/3 + 1/4 = 4/12 + 3/12 = 7/12
4. 注满整个水池需要：1 ÷ (7/12) = 12/7 小时
5. 转换为小时和分钟：12/7 = 1小时43分钟（约）

答案：大约1小时43分钟
```

#### 逻辑推理示例
```
问题：在一个会议上，每个人都与其他所有人握手一次。如果总共有45次握手，问有多少人参加会议？

思考过程：
1. 设有n个人参加会议
2. 每个人与其他(n-1)个人握手
3. 总握手次数 = n × (n-1) / 2（除以2是因为每次握手涉及两个人）
4. 建立方程：n × (n-1) / 2 = 45
5. 求解：n × (n-1) = 90
6. 展开：n² - n - 90 = 0
7. 使用求根公式：n = (1 ± √(1+360)) / 2 = (1 ± 19) / 2
8. n = 10 或 n = -9（舍去负数）

答案：10人参加会议
```

### 5. 零样本思维链（Zero-shot CoT）

#### 标准提示
```
问题：如果一家公司的收入增长了20%，但利润下降了5%，这说明了什么？

让我们一步步思考：
```

#### 增强版提示
```
问题：评估一个SaaS产品的定价策略是否合理。
基础版：$9/月
专业版：$29/月
企业版：$99/月

请按以下步骤分析：
第一步：分析价格梯度
第二步：考虑目标用户
第三步：对比市场竞品
第四步：给出结论和建议
```

### 6. 自我一致性（Self-Consistency）

#### 实施方法
```python
问题：一个项目需要5个开发者10天完成。如果只有3个开发者，需要多少天？

# 生成多个推理路径（Temperature=0.7）

路径1：
- 总工作量 = 5人 × 10天 = 50人天
- 3个开发者需要：50人天 ÷ 3人 = 16.67天

路径2：
- 工作效率比 = 5/3
- 所需时间 = 10天 × (5/3) = 16.67天

路径3：
- 如果5人需要10天，1人需要50天
- 3人需要：50天 ÷ 3 = 16.67天

最终答案：约17天（所有路径一致）
```

### 7. 知识生成提示（Generate Knowledge）

#### 两步法示例
```
步骤1 - 生成背景知识：
提示：列出关于"微服务架构"的关键知识点。

生成的知识：
1. 微服务是将应用拆分为小型、独立的服务
2. 每个服务负责单一业务功能
3. 服务间通过API通信
4. 可独立部署和扩展
5. 需要服务发现和负载均衡

步骤2 - 基于知识回答：
问题：为什么微服务架构适合大型团队？

基于上述知识的回答：
微服务架构适合大型团队因为：
1. 独立服务允许团队并行开发
2. 单一职责降低了协调成本
3. 独立部署减少了发布风险
4. 技术栈可以按服务选择
```

### 8. 提示链（Prompt Chaining）

#### 复杂任务分解示例
```
任务：为新产品制定上市策略

链条设计：

Step 1 - 市场分析：
输入：产品类别、目标市场
输出：市场规模、竞争格局、机会点

Step 2 - 用户画像：
输入：Step 1的市场分析结果
输出：目标用户特征、需求痛点、购买决策因素

Step 3 - 定位策略：
输入：Step 2的用户画像
输出：产品定位、差异化点、价值主张

Step 4 - 营销计划：
输入：Step 3的定位策略
输出：渠道选择、推广方式、预算分配

Step 5 - 执行方案：
输入：Step 4的营销计划
输出：时间表、KPI指标、风险预案
```

### 9. 思维树（Tree of Thoughts）

#### 问题解决示例
```
问题：设计一个高效的会议室预订系统

思维树结构：
根：会议室预订系统
├── 分支1：用户需求
│   ├── 子分支1.1：快速预订
│   ├── 子分支1.2：冲突检测
│   └── 子分支1.3：灵活修改
├── 分支2：技术方案
│   ├── 子分支2.1：实时同步
│   ├── 子分支2.2：移动端支持
│   └── 子分支2.3：集成日历
└── 分支3：优化策略
    ├── 子分支3.1：智能推荐
    ├── 子分支3.2：使用率分析
    └── 子分支3.3：自动释放

评估每个分支，选择最优路径组合
```

### 10. ReAct框架

#### 任务执行示例
```
任务：调试一个性能问题

Thought 1: 需要先确定性能瓶颈在哪里
Action 1: 运行性能分析工具
Observation 1: 数据库查询耗时占80%

Thought 2: 数据库是主要问题，需要检查慢查询
Action 2: 查看慢查询日志
Observation 2: 发现一个未使用索引的查询

Thought 3: 需要优化这个查询
Action 3: 添加合适的索引
Observation 3: 查询时间从5秒降到0.1秒

Thought 4: 验证整体性能改善
Action 4: 重新运行性能测试
Observation 4: 整体响应时间提升70%

结论：通过添加数据库索引解决了性能问题
```

## 高级提示技术

### 1. 主动提示（Active Prompting）

#### 不确定性采样
```python
# 选择模型最不确定的例子进行标注

候选示例：
1. "这个功能还行吧" - 置信度：0.45（不确定）
2. "非常棒的体验！" - 置信度：0.95（确定为正面）
3. "有点失望" - 置信度：0.52（较不确定）

选择示例1和3进行人工标注，因为模型对它们不确定
```

### 2. 方向性刺激提示（Directional Stimulus Prompting）

#### 引导式生成
```
任务：生成产品描述

方向性提示：
- 强调环保特性
- 突出性价比
- 面向年轻用户
- 使用活泼的语言

基于以上方向生成：
"这款环保材质的背包不仅让你的出行更轻松，还能为地球减负！超高性价比，一个包包=时尚+实用+环保，是追求可持续生活方式的你的完美选择！🌱"
```

### 3. 多模态CoT提示

#### 图表分析示例
```
[图表：月度销售趋势图]

分析步骤：
1. 观察：销售额在3-5月快速增长
2. 识别：6月出现明显下降
3. 对比：7-8月恢复但未达到5月峰值
4. 推理：可能受季节性因素影响
5. 建议：加强淡季营销，开发反季节产品
```

### 4. 程序辅助语言模型（PAL）

#### 复杂计算示例
```python
问题：计算复利投资回报

# 生成的Python代码
def calculate_compound_interest(principal, rate, time, n=12):
    """
    计算复利
    principal: 本金
    rate: 年利率
    time: 投资年数
    n: 每年复利次数
    """
    amount = principal * (1 + rate/n)**(n*time)
    interest = amount - principal
    return {
        'final_amount': round(amount, 2),
        'total_interest': round(interest, 2),
        'roi': round((interest/principal)*100, 2)
    }

# 执行计算
result = calculate_compound_interest(10000, 0.08, 5)
print(f"5年后总额：{result['final_amount']}")
print(f"总收益：{result['total_interest']}")
print(f"投资回报率：{result['roi']}%")
```

### 5. 检索增强生成（RAG）

#### 实现流程
```
用户查询："最新的前端框架趋势是什么？"

Step 1 - 检索相关文档：
- 文档1：2024年前端框架报告
- 文档2：Vue 3.4 新特性
- 文档3：React 19 路线图

Step 2 - 提取关键信息：
- Vue生态系统持续增长
- React Server Components成熟
- Solid.js性能优势明显

Step 3 - 综合生成回答：
基于最新数据，2024年前端框架趋势包括：
1. 服务器端组件（RSC）成为主流
2. 细粒度响应式获得更多关注
3. 构建工具向Rust迁移（如Turbopack）
4. AI辅助开发工具集成
```

## 特定领域应用

### 代码审查提示模板
```
请审查以下代码，关注：
1. 代码质量
   - 可读性
   - 可维护性
   - 设计模式
2. 性能问题
   - 时间复杂度
   - 空间复杂度
   - 潜在瓶颈
3. 安全隐患
   - 输入验证
   - 认证授权
   - 数据泄露
4. 最佳实践
   - 命名规范
   - 错误处理
   - 测试覆盖

代码：
[在此插入代码]
```

### 需求分析提示模板
```
作为产品经理，分析以下用户需求：

需求描述：[用户需求]

请提供：
1. 需求理解
   - 核心诉求
   - 使用场景
   - 目标用户
2. 可行性分析
   - 技术难度
   - 资源需求
   - 时间估算
3. 优先级建议
   - 业务价值
   - 用户影响
   - 实现成本
4. 实施方案
   - 功能设计
   - 交互流程
   - 成功指标
```

### 数据分析提示模板
```
分析以下数据集并提供洞察：

数据：[数据集]

分析维度：
1. 描述性统计
   - 均值、中位数、标准差
   - 分布特征
   - 异常值
2. 趋势分析
   - 时间序列模式
   - 增长率
   - 周期性
3. 相关性分析
   - 变量关系
   - 因果推断
   - 预测因子
4. 业务建议
   - 关键发现
   - 行动建议
   - 风险提示
```

## 提示优化技巧

### 1. A/B测试提示
```
版本A：简洁直接
"总结这篇文章的主要观点"

版本B：结构化详细
"请阅读这篇文章并：
1. 提取3-5个主要观点
2. 每个观点用一句话概括
3. 按重要性排序"

测试指标：准确性、完整性、可读性
```

### 2. 渐进式优化
```
迭代1：基础提示
"写一个Python函数"

迭代2：添加具体要求
"写一个Python函数，计算列表的平均值"

迭代3：增加约束
"写一个Python函数，计算列表的平均值，处理空列表情况，包含类型检查"

迭代4：完善细节
"写一个Python函数，计算数字列表的平均值：
- 处理空列表（返回None）
- 类型检查（只接受数字）
- 包含docstring
- 添加单元测试"
```

### 3. 负面提示（告诉模型不要做什么）
```
生成产品描述，但是：
- 不要使用夸张的营销语言
- 不要做不实的承诺
- 不要贬低竞争对手
- 不要使用技术术语

而是：
- 使用客观的描述
- 强调实际功能
- 使用用户友好的语言
```

## 常见错误与解决方案

### 错误1：提示过于模糊
```
❌ 错误："帮我写代码"
✅ 正确："写一个Python函数，接收用户列表，返回按年龄排序的结果"
```

### 错误2：缺少上下文
```
❌ 错误："优化这个"
✅ 正确："优化这个SQL查询的性能，当前在100万条记录上执行需要5秒"
```

### 错误3：格式不明确
```
❌ 错误："列出优缺点"
✅ 正确："以表格形式列出优缺点，包含以下列：特性|优点|缺点|评分(1-5)"
```

### 错误4：任务过于复杂
```
❌ 错误："创建一个完整的电商系统"
✅ 正确："设计电商系统的用户认证模块，包括注册、登录、密码重置功能"
```

## 评估和测试

### 评估框架
```python
def evaluate_prompt(prompt, test_cases):
    """
    评估提示效果
    """
    metrics = {
        'accuracy': 0,
        'consistency': 0,
        'completeness': 0,
        'relevance': 0
    }
    
    for case in test_cases:
        response = generate_response(prompt, case['input'])
        
        # 评估各项指标
        metrics['accuracy'] += check_accuracy(response, case['expected'])
        metrics['consistency'] += check_consistency(response)
        metrics['completeness'] += check_completeness(response)
        metrics['relevance'] += check_relevance(response, case['input'])
    
    # 计算平均分
    for key in metrics:
        metrics[key] /= len(test_cases)
    
    return metrics
```

### 测试用例设计
```
测试集应包含：
1. 正常案例（70%）
2. 边缘案例（20%）
3. 异常案例（10%）

示例：
- 正常：标准输入格式
- 边缘：最大/最小长度、特殊字符
- 异常：格式错误、缺失信息
```

## 总结

掌握这些提示技术需要：
1. **理解原理**：知道每种技术的工作机制
2. **选择合适**：根据任务特点选择技术
3. **持续优化**：通过测试和迭代改进
4. **组合使用**：灵活组合多种技术
5. **领域适配**：根据具体领域调整

记住：提示工程是一个迭代过程，没有一劳永逸的完美提示，需要根据实际效果不断调整优化。